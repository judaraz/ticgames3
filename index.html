<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Ludo Dice - Win Rewards</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- Telegram WebApp -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<!-- RichAds SDK -->
<script src="https://richinfo.co/richpartners/telegram/js/tg-ob.js"></script>

<!-- Adexium SDK -->
<script src="https://cdn.tgads.space/assets/js/adexium-widget.min.js"></script>

<style>
/* ---- styles unchanged ---- */
:root {
    --telegram-blue:#3390ec;
    --telegram-dark:#18222d;
    --gold:#ffd700;
    --success:#34c759;
}
body{
    font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
    background:var(--telegram-dark);
    color:#fff;
    min-height:100vh;
    padding:16px;
    padding-bottom:140px;
}
.container{max-width:420px;margin:auto}
.roll-btn{background:var(--telegram-blue);color:#fff;border:none;padding:18px;border-radius:12px;font-size:18px;width:100%}
.popup-overlay{position:fixed;inset:0;background:rgba(0,0,0,.9);display:none;align-items:center;justify-content:center;z-index:1000}
.popup{background:#fff;border-radius:16px;padding:24px;width:100%;max-width:320px;text-align:center}
.popup-btn{background:var(--success);border:none;color:#fff;padding:16px;border-radius:12px;width:100%;margin-top:16px}
</style>
</head>

<body>

<div class="container">
    <h2 style="text-align:center;color:#ffd700">üé≤ LUDO DICE ROLL</h2>
    <p style="text-align:center;opacity:.7">Roll dice, win points, get rewards!</p>

    <div style="text-align:center;margin:20px 0">
        <div>YOUR POINTS</div>
        <div id="pointsValue" style="font-size:36px;color:#ffd700">1,000</div>
    </div>

    <button class="roll-btn" id="rollBtn">
        <i class="fas fa-dice"></i> ROLL DICE - 100 POINTS
    </button>
</div>

<!-- Result Popup -->
<div class="popup-overlay" id="resultPopup">
    <div class="popup">
        <h3>üéâ YOU WON</h3>
        <div id="winAmount" style="font-size:28px;color:#34c759;margin:10px 0"></div>
        <button class="popup-btn" id="claimBtn">CLAIM PRIZE</button>
    </div>
</div>

<!-- Ads Popup -->
<div class="popup-overlay" id="adsPopup">
    <div class="popup">
        <h3>üéÅ BONUS REWARD</h3>
        <div id="adsContainer" style="margin:20px 0;color:#555">
            Loading ad...
        </div>
        <button class="popup-btn" id="closeAdsBtn" style="display:none;background:#3390ec">
            CONTINUE (+50)
        </button>
    </div>
</div>

<script>
/* ================== TELEGRAM ================== */
if (window.Telegram?.WebApp) {
    Telegram.WebApp.ready();
    Telegram.WebApp.expand();
}

/* ================== ADS INIT ================== */
let richAdsLoaded = false;
let adexiumAds = null;

/* RichAds */
try {
    window.TelegramAdsController = new TelegramAdsController();
    TelegramAdsController.initialize({ pubId: "956231", appId: "5595" });
    richAdsLoaded = true;
} catch(e){}

/* Adexium Advanced Init */
document.addEventListener('DOMContentLoaded', () => {
    adexiumAds = new AdexiumWidget({
        wid: '30015b9a-df1e-4895-be7b-c5bc1b148fcf',
        adFormat: 'interstitial',
        debug: false
    });

    adexiumAds.on('adReceived', ad => {
        adexiumAds.displayAd(ad);
    });

    adexiumAds.on('noAdFound', () => {
        showMockAd();
    });

    adexiumAds.on('adClosed', () => {
        giveBonus();
    });
});

/* ================== GAME ================== */
let points = 1000;
let currentWin = 0;

const pointsValue = document.getElementById('pointsValue');
const rollBtn = document.getElementById('rollBtn');
const resultPopup = document.getElementById('resultPopup');
const adsPopup = document.getElementById('adsPopup');
const winAmount = document.getElementById('winAmount');
const claimBtn = document.getElementById('claimBtn');
const closeAdsBtn = document.getElementById('closeAdsBtn');
const adsContainer = document.getElementById('adsContainer');

function updatePoints(){
    pointsValue.textContent = points.toLocaleString();
}

rollBtn.onclick = () => {
    if(points < 100) return;
    points -= 100;
    const dice = Math.floor(Math.random()*6)+1;
    currentWin = dice * 100;
    updatePoints();
    winAmount.textContent = currentWin + " POINTS";
    resultPopup.style.display = 'flex';
};

claimBtn.onclick = () => {
    points += currentWin;
    updatePoints();
    resultPopup.style.display = 'none';
    setTimeout(showBonusAds,300);
};

/* ================== BONUS ADS FLOW ================== */
function showBonusAds(){
    adsPopup.style.display = 'flex';
    closeAdsBtn.style.display = 'none';
    adsContainer.textContent = "Loading reward...";

    if(richAdsLoaded){
        try{
            TelegramAdsController.showAd();
            setTimeout(giveBonus,5000);
            return;
        }catch(e){}
    }

    if(adexiumAds){
        adexiumAds.requestAd('interstitial');
    }else{
        showMockAd();
    }
}

function giveBonus(){
    adsContainer.innerHTML = "<b style='color:#34c759'>+50 BONUS POINTS</b>";
    points += 50;
    updatePoints();
    closeAdsBtn.style.display = 'block';
}

function showMockAd(){
    setTimeout(giveBonus,1500);
}

closeAdsBtn.onclick = () => {
    adsPopup.style.display = 'none';
};

/* Init */
updatePoints();
</script>

</body>
</html>
