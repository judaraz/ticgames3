<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Ludo Dice â€“ Dual Ads</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- Telegram -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<!-- RichAds -->
<script src="https://richinfo.co/richpartners/telegram/js/tg-ob.js"></script>

<!-- Adexium -->
<script src="https://cdn.tgads.space/assets/js/adexium-widget.min.js"></script>
<script src="https://cdn.atechp.space/assets/js/pp.min.js"></script>

<style>
body {
    margin: 0;
    font-family: system-ui, sans-serif;
    background: #0f141b;
    color: #fff;
    padding: 16px 16px 120px;
}
.container {
    max-width: 420px;
    margin: auto;
}
.points {
    font-size: 42px;
    font-weight: 800;
    color: #ffd700;
    text-align: center;
    margin: 20px 0;
}
button {
    width: 100%;
    padding: 18px;
    border-radius: 14px;
    border: none;
    font-size: 18px;
    font-weight: 600;
    cursor: pointer;
}
.roll-btn {
    background: #3390ec;
    color: #fff;
}
.ad-btn {
    margin-top: 16px;
    background: #ff6b6b;
    color: #fff;
}
.ad-btn:disabled {
    opacity: .6;
    cursor: not-allowed;
}
.popup {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.85);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 999;
}
.popup-box {
    background: #1e2a38;
    padding: 24px;
    border-radius: 16px;
    width: 90%;
    max-width: 320px;
    text-align: center;
}
.small {
    font-size: 13px;
    opacity: .7;
}
</style>
</head>

<body>
<div class="container">

<h2 style="text-align:center">ðŸŽ² LUDO DICE</h2>

<div class="points" id="points">1000</div>

<button class="roll-btn" id="rollBtn">
<i class="fas fa-dice"></i> ROLL DICE (100 pts)
</button>

<button class="ad-btn" id="watchAdBtn" disabled>
<i class="fas fa-spinner fa-spin"></i> PREPARING ADSâ€¦
</button>

<div class="small" style="text-align:center;margin-top:10px">
Both ads must be available to continue
</div>

</div>

<!-- RESULT -->
<div class="popup" id="resultPopup">
    <div class="popup-box">
        <h3>ðŸŽ‰ YOU WON</h3>
        <div style="font-size:48px" id="diceEmoji">ðŸŽ²</div>
        <div style="font-size:28px;color:#34c759" id="winAmount"></div>
        <button id="claimBtn" style="margin-top:16px;background:#34c759;color:#fff">
            CLAIM
        </button>
    </div>
</div>

<script>
/* ================= TELEGRAM ================= */
if (window.Telegram?.WebApp) {
    Telegram.WebApp.ready();
    Telegram.WebApp.expand();
}

/* ================= STATE ================= */
let points = 1000;
let currentWin = 0;

/* ================= DOM ================= */
const pointsEl = document.getElementById('points');
const rollBtn = document.getElementById('rollBtn');
const watchAdBtn = document.getElementById('watchAdBtn');
const popup = document.getElementById('resultPopup');
const diceEmoji = document.getElementById('diceEmoji');
const winAmount = document.getElementById('winAmount');
const claimBtn = document.getElementById('claimBtn');

/* ================= UI ================= */
function updatePoints() {
    pointsEl.textContent = points.toLocaleString();
    rollBtn.disabled = points < 100;
}

/* ================= DICE ================= */
function rollDice() {
    if (points < 100) return;

    points -= 100;
    updatePoints();

    const dice = Math.floor(Math.random() * 6) + 1;
    currentWin = dice * 100;

    const emojis = ['âš€','âš','âš‚','âšƒ','âš„','âš…'];
    diceEmoji.textContent = emojis[dice - 1];
    winAmount.textContent = `+${currentWin} POINTS`;

    popup.style.display = 'flex';
}

/* ================= CLAIM ================= */
function claimPrize() {
    popup.style.display = 'none';
    points += currentWin;
    updatePoints();
    showBothAds();
}

/* ================= ADS STATE ================= */
let adexiumReady = false;
let richAdsReady = false;
let adexiumInterstitial = null;
let retryTimer = null;

/* ================= ADEXIUM ================= */
function initAdexium() {
    if (typeof AdexiumWidget === 'undefined') return;

    adexiumInterstitial = new AdexiumWidget({
        wid: '30015b9a-df1e-4895-be7b-c5bc1b148fcf',
        adFormat: 'interstitial'
    });

    adexiumInterstitial.autoMode();
    adexiumReady = true;
}

/* ================= RICHADS ================= */
function initRichAds() {
    try {
        if (typeof TelegramAdsController !== 'undefined') {
            window.TelegramAdsController = new TelegramAdsController();
            TelegramAdsController.initialize({
                pubId: '956231',
                appId: '5595'
            });
            richAdsReady = true;
        }
    } catch (e) {}
}

/* ================= RETRY LOOP ================= */
function startAdRetryLoop() {
    retryTimer = setInterval(() => {
        initAdexium();
        initRichAds();
        checkAdsReady();
    }, 3000);
}

/* ================= READY CHECK ================= */
function checkAdsReady() {
    if (adexiumReady && richAdsReady) {
        clearInterval(retryTimer);
        watchAdBtn.disabled = false;
        watchAdBtn.innerHTML = '<i class="fas fa-tv"></i> WATCH BOTH ADS (+50)';
    }
}

/* ================= SHOW BOTH ADS ================= */
function showBothAds() {
    watchAdBtn.disabled = true;
    watchAdBtn.innerHTML = 'SHOWING ADSâ€¦';

    // 1ï¸âƒ£ Show Adexium
    try {
        adexiumInterstitial.autoMode();
    } catch (e) {
        startAdRetryLoop();
        return;
    }

    // 2ï¸âƒ£ After delay, show RichAds
    setTimeout(() => {
        try {
            TelegramAdsController.show();
        } catch (e) {
            startAdRetryLoop();
            return;
        }

        // 3ï¸âƒ£ Reward AFTER BOTH ATTEMPTS
        setTimeout(() => {
            points += 50;
            updatePoints();
            watchAdBtn.innerHTML = '<i class="fas fa-tv"></i> WATCH BOTH ADS (+50)';
            watchAdBtn.disabled = false;
        }, 1500);

    }, 2000);
}

/* ================= EVENTS ================= */
rollBtn.onclick = rollDice;
claimBtn.onclick = claimPrize;
watchAdBtn.onclick = showBothAds;
popup.onclick = e => { if (e.target === popup) popup.style.display = 'none'; };

/* ================= INIT ================= */
updatePoints();
startAdRetryLoop();
</script>
</body>
</html>
