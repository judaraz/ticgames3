<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Ludo Dice - Win Rewards</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- Telegram WebApp -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<!-- RichAds SDK (Primary) -->
<script src="https://richinfo.co/richpartners/telegram/js/tg-ob.js"></script>

<!-- TADS SDK (Fallback) -->
<script src="https://w.tads.me/widget.js" async></script>

<style>
:root {
  --telegram-blue:#3390ec;
  --telegram-dark:#18222d;
  --gold:#ffd700;
  --success:#34c759;
}
*{margin:0;padding:0;box-sizing:border-box}
body{
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  background:var(--telegram-dark);
  color:#fff;
  min-height:100vh;
  padding:16px;
}
.container{
  max-width:420px;
  margin:auto;
  display:flex;
  flex-direction:column;
  gap:16px
}
.game-header{
  text-align:center;
  padding:20px;
  background:rgba(255,255,255,.05);
  border-radius:16px
}
.game-title{
  font-size:26px;
  color:var(--gold);
  font-weight:800
}
.points-container{
  background:linear-gradient(135deg,#2c3e50,#3498db);
  padding:20px;
  border-radius:16px;
  text-align:center
}
.points-value{
  font-size:36px;
  font-weight:900;
  color:var(--gold)
}
.ludo-board{
  width:260px;
  height:260px;
  background:#fff;
  margin:auto;
  border-radius:16px;
  position:relative
}
.dice{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  font-size:48px
}
.controls{
  background:rgba(255,255,255,.05);
  padding:16px;
  border-radius:16px
}
.roll-btn{
  width:100%;
  padding:16px;
  font-size:18px;
  background:var(--telegram-blue);
  border:none;
  border-radius:12px;
  color:#fff
}
.popup-overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:999
}
.popup{
  background:#fff;
  color:#000;
  border-radius:16px;
  width:100%;
  max-width:320px;
  padding:20px;
  text-align:center
}
.popup-btn{
  margin-top:16px;
  padding:14px;
  width:100%;
  border:none;
  border-radius:12px;
  color:#fff;
  background:var(--success)
}
.ads-content{
  min-height:180px;
  display:flex;
  align-items:center;
  justify-content:center
}
</style>
</head>

<body>

<div class="container">
  <div class="game-header">
    <div class="game-title">üé≤ LUDO DICE</div>
    <p>Roll dice & win rewards</p>
  </div>

  <div class="points-container">
    <div>YOUR POINTS</div>
    <div class="points-value" id="pointsValue">1,000</div>
  </div>

  <div class="ludo-board">
    <div class="dice" id="dice">‚öÖ</div>
  </div>

  <div class="controls">
    <button class="roll-btn" id="rollBtn">
      <i class="fas fa-dice"></i> ROLL (100 POINTS)
    </button>
  </div>
</div>

<!-- RESULT POPUP -->
<div class="popup-overlay" id="resultPopup">
  <div class="popup">
    <h2>üéâ YOU WON</h2>
    <div id="winAmount" style="font-size:32px;margin:12px 0"></div>
    <button class="popup-btn" id="claimBtn">CLAIM</button>
  </div>
</div>

<!-- ADS POPUP -->
<div class="popup-overlay" id="adsPopup">
  <div class="popup">
    <h2>üéÅ BONUS</h2>
    <div class="ads-content" id="adsContainer">
      Loading ad...
    </div>
    <button class="popup-btn" id="closeAdsBtn" style="display:none;background:var(--telegram-blue)">
      CONTINUE (+50)
    </button>
  </div>
</div>

<script>
/* ================= TELEGRAM ================= */
if (window.Telegram?.WebApp) {
  Telegram.WebApp.ready();
  Telegram.WebApp.expand();
}

/* ================= STATE ================= */
let points = 1000;
let currentWin = 0;
let richAdsLoaded = false;
let tadsReady = false;
let tadsController = null;

/* ‚úÖ TADS WIDGET ID SET */
const TADS_WIDGET_ID = "9154";

/* ================= DOM ================= */
const rollBtn = document.getElementById("rollBtn");
const dice = document.getElementById("dice");
const pointsValue = document.getElementById("pointsValue");
const resultPopup = document.getElementById("resultPopup");
const winAmount = document.getElementById("winAmount");
const claimBtn = document.getElementById("claimBtn");
const adsPopup = document.getElementById("adsPopup");
const adsContainer = document.getElementById("adsContainer");
const closeAdsBtn = document.getElementById("closeAdsBtn");

/* ================= RICHADS ================= */
try {
  window.TelegramAdsController = new TelegramAdsController();
  TelegramAdsController.initialize({
    pubId:"956231",
    appId:"5595"
  });
  richAdsLoaded = true;
} catch(e) {
  console.log("RichAds not available");
}

/* ================= GAME ================= */
function updatePoints(){
  pointsValue.textContent = points.toLocaleString();
}

function rollDice(){
  if(points < 100) return;
  points -= 100;

  const d = Math.floor(Math.random()*6)+1;
  dice.textContent = ["‚öÄ","‚öÅ","‚öÇ","‚öÉ","‚öÑ","‚öÖ"][d-1];
  currentWin = d * 100;

  updatePoints();
  setTimeout(()=>{
    winAmount.textContent = currentWin + " POINTS";
    resultPopup.style.display = "flex";
  },400);
}

function claimPrize(){
  points += currentWin;
  updatePoints();
  resultPopup.style.display = "none";
  setTimeout(showAdsForBonus,300);
}

/* ================= ADS FLOW ================= */
function showAdsForBonus(){
  adsPopup.style.display = "flex";
  closeAdsBtn.style.display = "none";
  adsContainer.textContent = "Loading ad...";

  if(richAdsLoaded){
    try{
      TelegramAdsController.showAd();
      setTimeout(giveBonus,5000);
      return;
    }catch{}
  }
  showTadsAd();
}

async function showTadsAd(){
  if(!tadsReady){
    await new Promise(resolve=>{
      const iv = setInterval(()=>{
        if(window.tads?.init){
          clearInterval(iv);
          tadsReady = true;
          resolve();
        }
      },50);
    });
  }

  if(!tadsController){
    tadsController = window.tads.init({
      widgetId: TADS_WIDGET_ID,
      type: "fullscreen",
      onShowReward: giveBonus,
      onAdsNotFound: giveBonus
    });
  }

  tadsController.showAd().catch(giveBonus);
}

function giveBonus(){
  adsContainer.innerHTML = "<b>+50 BONUS</b>";
  points += 50;
  updatePoints();
  closeAdsBtn.style.display = "block";
}

function closeAds(){
  adsPopup.style.display = "none";
}

/* ================= EVENTS ================= */
rollBtn.onclick = rollDice;
claimBtn.onclick = claimPrize;
closeAdsBtn.onclick = closeAds;
updatePoints();
</script>

</body>
</html>
